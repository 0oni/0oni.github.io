<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de ejemplo</title>
    <style>
        /* Estilos ... */
    </style>
</head>
<body>

    <form id="crud-form">
        <!-- Tu formulario actual -->
        <button type="submit">Enviar</button>
    </form>

    <!-- Área para mostrar la lista de elementos -->
    <div id="lista-elementos"></div>

    <script type="module">
        // Importar las funciones necesarias de Firebase

        // Tu configuración de Firebase

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Función para crear un nuevo registro
        window.crearRegistro = function () {
            event.preventDefault();
            const nombre = document.getElementById("nombre").value;
            const apellido = document.getElementById("apellido").value;
            const email = document.getElementById("email").value;
            const edad = document.getElementById("edad").value;
            const cedula = document.getElementById("cedula").value;

            push(
                ref(database, 'formulario01'),
                {
                    name: nombre,
                    last_name: apellido,
                    email: email,
                    age: edad,
                    card: cedula 
                }
            );
            document.getElementById("crud-form").reset();
            actualizarLista(); // Llamada para actualizar la lista
        };

        // Agregar evento de submit al formulario
        document.getElementById("crud-form").addEventListener("submit", crearRegistro);

        // Función para actualizar la lista de elementos
        function actualizarLista() {
            const listaElementos = document.getElementById("lista-elementos");

            // Limpiar la lista antes de actualizar
            listaElementos.innerHTML = "";

            // Obtener los elementos desde Firebase y mostrarlos en la lista
            // (Implementación según la estructura de tus datos en la base de datos)
            // Puedes usar 'onValue' para mantener la lista actualizada en tiempo real

            // Ejemplo básico de cómo puedes mostrar los elementos:
            const elementosRef = ref(database, 'formulario01');
            onValue(elementosRef, (snapshot) => {
                const elementos = snapshot.val();
                for (const key in elementos) {
                    if (Object.hasOwnProperty.call(elementos, key)) {
                        const elemento = elementos[key];
                        const listItem = document.createElement("div");
                        listItem.innerHTML = `
                            <strong>${elemento.name} ${elemento.last_name}</strong> (${elemento.age} años)<br>
                            Email: ${elemento.email}<br>
                            Cédula: ${elemento.card}<br>
                            <button onclick="editarElemento('${key}')">Editar</button>
                            <button onclick="eliminarElemento('${key}')">Eliminar</button>
                            <hr>
                        `;
                        listaElementos.appendChild(listItem);
                    }
                }
            });
        }

        // Función para editar un elemento (a implementar según tus necesidades)
        window.editarElemento = function (key) {
            // Implementa la lógica de edición según tus necesidades
            console.log("Editar elemento con clave:", key);
        };

        // Función para eliminar un elemento
        window.eliminarElemento = function (key) {
            // Implementa la lógica de eliminación según tus necesidades
            remove(ref(database, `formulario01/${key}`));
            console.log("Eliminar elemento con clave:", key);
            actualizarLista(); // Actualizar la lista después de eliminar
        };

        // Inicializar la lista al cargar la página
        actualizarLista();
    </script>
</body>
</html>
